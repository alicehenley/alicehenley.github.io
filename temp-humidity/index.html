<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-145052584-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-145052584-1');
</script>
  <meta charset="utf-8">
  <title>Office temperature</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Read about me, my adventures in the outdoors or my scientific research">
  <meta name="author" content="Alice Henley">
  <!-- styles -->
  <link href="/assets/css/bootstrap.css" rel="stylesheet">
  <link href="/assets/css/bootstrap-responsive.css" rel="stylesheet">
  <link href="/assets/css/prettyPhoto.css" rel="stylesheet">
  <link href="/assets/js/google-code-prettify/prettify.css" rel="stylesheet">
  <link href="/assets/css/flexslider.css" rel="stylesheet">
  <link href="/assets/css/main.css" rel="stylesheet">
  <link href="/assets/color/purple.css" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css"><!-- -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/v4-shims.css"><!-- -->

  <link href="https://fonts.googleapis.com/css?family=Lato:400,600,400italic|Open+Sans:400,600,700" rel="stylesheet">

  <!-- AH: Added from the snazzy favicon maker website -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/ico/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/ico/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/ico/favicon-16x16.png">
  <link rel="manifest" href="/assets/ico/site.webmanifest">
  <link rel="mask-icon" href="/assets/ico/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-config" content="/assets/ico/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

  <!-- fav and touch icons -->
  <link rel="shortcut icon" href="/assets/ico/favicon.ico">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/ico/apple-touch-icon-144-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/ico/apple-touch-icon-114-precomposed.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/ico/apple-touch-icon-72-precomposed.png">
  <link rel="apple-touch-icon-precomposed" href="/assets/ico/apple-touch-icon-57-precomposed.png">

  <!-- =======================================================
    Theme Name: Lumia
    Theme URL: https://bootstrapmade.com/lumia-bootstrap-business-template/
    Author: BootstrapMade.com
    Author URL: https://bootstrapmade.com
  ======================================================= -->
  <meta property="og:title" content="Alice? Alice? Who the...">
  <meta property="og:description" content="Read about me, my adventures in the outdoors or my scientific research">
  <meta property="og:image" content="https://alicehenley.github.io/assets/ico/android-chrome-512x512.png">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://alicehenley.github.io/about/">
</head>

<body>
  <div id="wrapper">
    <header>
      <!-- Navbar
    ================================================== -->
      <div class="navbar navbar-static-top">
        <div class="navbar-inner">
          <div class="container">
            <!-- logo -->
            <div class="logo">
              <a href="/">
                <!-- Alice Henley -->
                <img src="/assets/img/logo.png" alt>
              </a>
            </div>
            <!-- end logo -->

            <!-- top menu -->
            <div class="navigation">
              <nav>
                <ul class="nav topnav">
                  <li>
                    <a href="/"><i class="fas fa-home"></i>  Home </a>
                  </li>
                  <li>
                    <a href="/about/"><i class="fas fa-user-ninja"></i>  About </a>
                  </li>
                  <li>
                    <a href="/blog/"><i class="fas fa-hiking"></i>  Adventures blog</a>
                  </li>
                  <!-- <li class="dropdown"> -->
                  <!-- <a href="#"><i class="icon-book"></i> Adventures <i class="icon-angle-down"></i></a> -->
                  <!-- <ul class="dropdown-menu"> -->
                  <!-- <li><a href="blog-left-sidebar.html">Blog left sidebar</a></li> -->
                  <!-- <li><a href="/unusedlumia/blog-right-sidebar.html">Blog right sidebar</a></li> -->
                  <!-- <li><a href="/unusedlumia/post-left-sidebar.html">Post left sidebar</a></li> -->
                  <!-- <li><a href="/unusedlumia/post-right-sidebar.html">Post right sidebar</a></li> -->
                  <!-- </ul> -->
                  <!-- </li> -->
                  <li>
                    <a href="/research/"><i class="fas fa-flask"></i>  Research </a>
                  </li>
                  <li class="dropdown active">
                    <a href="#"><i class="fas fa-magic"></i>  Other pages  <i class="fas fa-angle-down"></i></a>
                    <ul class="dropdown-menu">
                      <li><a href="/seminar-timer/"><i class="fas fa-stopwatch"></i>  Seminar timer</a></li>
					  <li><a href="/netlogo-fireworks/"><i class="fas fa-fire"></i>  NetLogo fireworks</a></li>
					  <li><a href="/temp-humidity/"><i class="fas fa-thermometer-half"></i>  Office temperature</a></li>
                      <!-- <li><a href="/unusedlumia/portfolio-2cols.html">Portfolio 2 columns</a></li> -->
                      <!-- <li><a href="/unusedlumia/portfolio-3cols.html">Portfolio 3 columns</a></li> -->
                      <!-- <li><a href="/unusedlumia/portfolio-4cols.html">Portfolio 4 columns</a></li> -->
                      <!-- <li><a href="/unusedlumia/portfolio-detail.html">Portfolio detail</a></li> -->
                      <!-- <li><a href="/unusedlumia/media.html">Media</a></li> -->
                      <!-- <li><a href="/unusedlumia/color-scheme.html">10 Theme colors</a></li> -->
                      <!-- <li><a href="/unusedlumia/buttons.html">Buttons</a></li> -->
                      <!-- <li><a href="/unusedlumia/components.html">Components</a></li> -->
                      <!-- <li><a href="/unusedlumia/animations.html">56 Animations</a></li> -->
                      <!-- <li><a href="/unusedlumia/icons.html">Icons</a></li> -->
                      <!-- <li><a href="/unusedlumia/icon-variations.html">Icon variations</a></li> -->
                      <!-- <li class="dropdown"><a href="#">3rd level <i class="icon-angle-right"></i></a> -->
                        <!-- <ul class="dropdown-menu sub-menu"> -->
                          <!-- <li><a href="#">Example menu</a></li> -->
                          <!-- <li><a href="#">Example menu</a></li> -->
                          <!-- <li><a href="#">Example menu</a></li> -->
                        <!-- </ul> -->
                      <!-- </li> -->
                      <!-- <li><a href="/unusedlumia/pricingbox.html">Pricing boxes</a></li> -->
                      <!-- <li><a href="/unusedlumia/testimonials.html">Testimonials</a></li> -->
                      <!-- <li><a href="/unusedlumia/404.html">404</a></li> -->
                    </ul>
                  </li>
                </ul>
              </nav>
            </div>
            <!-- end menu -->

          </div>
        </div>
      </div>
    </header>
    <!-- Subintro
================================================== -->
    <section id="subintro">
      <div class="container">
        <div class="row">
          <div class="span8">
            <ul class="breadcrumb">
              <li><a href="/"><i class="fas fa-home"></i></a> <i class="fas fa-angle-right"></i></li>&nbsp;
              <li><a href="#">Other pages</a>&nbsp;<i class="fas fa-angle-right"></i></li>&nbsp;
              <li class="active">Office temperature</li>
            </ul>
          </div>
          <!-- <div class="span4"> -->
          <!-- <div class="search"> -->
          <!-- <form class="input-append"> -->
          <!-- <input class="search-form" id="appendedPrependedInput" type="text" placeholder="Search here.." /> -->
          <!-- <button class="btn btn-dark" type="submit">Search</button> -->
          <!-- </form> -->
          <!-- </div> -->
          <!-- </div> -->
        </div>
      </div>
    </section>
    <section id="maincontent">
      <div class="container">
		<div class="row">
			<h3>Temperature and relative humidity recorded from within my loft office</h3>
			The plot below shows data recorded over the last 24 hours. Data is recorded live and updates when the page is refreshed. 
			The setup is simple: a DHT11 sensor<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> connected to a NodeMCU ESP-12E board that sends the readings to a ThingSpeak channel. From there the data can be analysed and presented as shown below.
		</div>
		<div class="row">
			<div class="span12" align="center">
				<div style="position: relative; overflow: hidden; padding-top: 57.78%; width: 80%; height: 80%;" align="center"><!-- id="framewrap"> -->
					<iframe style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" src="https://thingspeak.com/apps/matlab_visualizations/383044?width=auto&height=auto"></iframe>
					<!-- width="450"  height="260" -->
				</div>
			</div>
		</div>	
		<div class="row">
          <div class="span4 features e_pulse">
            <div class="box">
              <div class="divcenter">
                <h4 id="recentTempTime">Most recent</h4>
						<script>
								fetch("https://api.thingspeak.com/channels/1268628/feeds.json?results=1")
								  .then(function (response) {
									return response.json();
								  })
								  .then(function (myJson) {
									var dateTimeRecent = new Date(myJson.feeds["0"].created_at);
									//dateTimeRecent = myJson.feeds["0"].created_at;
									
									const dateRecentSplit = dateTimeRecent.toDateString().split(' ');
									const dateRecent = dateRecentSplit[1] + ' ' + dateRecentSplit[2];
									const timeRecent = dateTimeRecent.toTimeString().split(' ')[0];;
									
									document.querySelector("#recentTempTime").innerHTML = 'Most recent (' + timeRecent + ', ' + dateRecent + ')';
																
									const recentTemp = myJson.feeds["0"].field1 ;
									document.querySelector("#recentTemp").innerHTML = 'Temperature: ' + parseFloat(recentTemp).toFixed(1) + '&nbsp;&deg;C';
									
									const recentHumi = myJson.feeds["0"].field2 ;
									document.querySelector("#recentHumi").innerHTML = 'Rel. Humidity: ' + parseFloat(recentHumi).toFixed(0) + '&nbsp;%';
								  })
								  .catch(function (error) {
									console.log("Error: " + error);
								  }
								);
							</script>
                <p id="recentTemp"></p>
                <p id="recentHumi"></p>
              </div>
            </div>
          </div>
          <div class="span4 features e_pulse">
            <div class="box">
              <div class="divcenter">
                <h4>Average (last hour)</h4>
						<script>
								fetch("https://api.thingspeak.com/channels/1268628/feeds.json?results=240&average=60")
								  .then(function (responseHr) {
									return responseHr.json();
								  })
								  .then(function (myJsonHour) {
									const hourTemp = myJsonHour.feeds["0"].field1 ;
									document.querySelector("#hourTemp").innerHTML = 'Temperature: ' + parseFloat(hourTemp).toFixed(1) + '&nbsp;&deg;C';
									
									const hourHumi = myJsonHour.feeds["0"].field2 ;
									document.querySelector("#hourHumi").innerHTML = 'Rel. Humidity: ' + parseFloat(hourHumi).toFixed(0) + '&nbsp;%';
								  })
								  .catch(function (errorHr) {
									console.log("Error: " + errorHr);
								  }
								);
							</script>
                <p id="hourTemp"></p>
                <p id="hourHumi"></p>
              </div>
            </div>
          </div>

          <div class="span4 features e_pulse">
            <div class="box">
              <div class="divcenter">
                <h4> Average (last day) </h4>
						<script>
								/* fetch("https://api.thingspeak.com/channels/1268628/feeds.json?days=1&average=daily") */
								fetch("https://api.thingspeak.com/channels/1268628/feeds.json?days=1")
								  .then(function (responseDay) {
									return responseDay.json();
								  })
								  .then(function (myJsonDay) {
									var rollingSumT = 0.0;
									var rollingSumH = 0.0;
									var fieldsT = myJsonDay.feeds.length;
									var fieldsH = fieldsT;
									var currT = 0.0;
									
									for (var i = 0; i<fieldsT; i++){
										if (0<myJsonDay.feeds[i].field1<100 && myJsonDay.feeds[i].field1!='nan') {
											rollingSumT += +myJsonDay.feeds[i].field1;
										}
										else {
											fieldsT--;
										}
										if (0<myJsonDay.feeds[i].field2<100 && myJsonDay.feeds[i].field1!='nan') {
											rollingSumH = +rollingSumH + +myJsonDay.feeds[i].field2;
										}
										else {
											fieldsH--;
										}
									}
									
									/*const dayTemp = myJsonDay.feeds["0"].field1 ;
									document.querySelector("#dayTemp").innerHTML = 'Temperature: ' + parseFloat(dayTemp).toFixed(1) + '&nbsp;&deg;C';
									
									const dayHumi = myJsonDay.feeds["0"].field2 ;
									document.querySelector("#dayHumi").innerHTML = 'Rel. Humidity: ' + parseFloat(dayHumi).toFixed(0) + '&nbsp;%';*/
									
									var aveDayT = rollingSumT / fieldsT;
									var aveDayH = rollingSumH / fieldsH;
									
									document.querySelector("#dayTemp").innerHTML = 'Temperature: ' + parseFloat(aveDayT).toFixed(1) + '&nbsp;&deg;C';
									document.querySelector("#dayHumi").innerHTML = 'Rel. Humidity: ' + parseFloat(aveDayH).toFixed(0) + '&nbsp;%';
								  })
								  .catch(function (errorDay) {
									console.log("Error: " + errorDay);
								  }
								);
							</script>
                <p id="dayTemp"></p>
                <p id="dayHumi"></p>
              </div>
            </div>
          </div>
        </div>
			<hr>
			<div class="footnotes">
				<ol>
					<li id="fn:1">
						<p>The sensor isn't great. The datasheet suggests a range of 0-50 &deg;C with accuracy of &plusmn;2 &deg;C for temperature and a range of 20-90 % with accuracy of &plusmn;5 % for relative humidity.</p>
					</li> 
				</ol>
			</div>
		</div>
		
		<!-- <div class="row">
			<div class="span12" align="center">
							
				<b>Minimum temperature (last 24 hours):</b>&nbsp;X&nbsp;&deg;C (Date/Time)<br>
				<b>Maximum temperature (last 24 hours):</b>&nbsp;X&nbsp;&deg;C (Date/Time)<p id="maxTempDay"></p>
			</div>		
		</div> -->
      </div> 
    </section>
    <!-- Footer
 ================================================== -->
    <footer class="footer">
    <div class="container">
        <div class="row">
        <div class="span4">
          <div class="widget">
            <h5> Read more</h5>
            <ul class="regular">
              <li><a href="/about/">About me</a></li>
              <li><a href="/blog/">Adventures blog</a></li>
              <li><a href="/research/">Scientific research</a></li>
              <li><a href="/seminar-timer/">Seminar timer</a></li>
              <!-- <li><a href="#">Press releases</a></li> -->
              <!-- <li><a href="#">Get in touch with us</a></li> -->
            </ul>
          </div>
        </div>
        <div class="span4">
          <div class="widget">
            
          </div>

        </div>
        <div class="span4">
          <div class="widget">
            <h5>Get in touch</h5>
            <!-- <address> -->
            <!-- <i class="icon-home"></i> <strong>Lumia company, Inc.</strong><br> -->
            <!-- X104 Awesome ville, Suite AB12<br> -->
            <!-- Jakarta 12420 Indonesia -->
            <!-- </address> -->
            <p>
              <!-- <i class="icon-phone"></i> (123) 456-7890 - (123) 555-8890<br> -->
              <i class="far fa-envelope"></i>  alicehenley@outlook.com
            </p>
          </div>
          <div class="widget">
              <ul class="social">
				<li><a href="https://www.instagram.com/alicehnom/" data-placement="bottom" title="Instagram"><i class="fab fa-instagram icon-social icon-48"></i></a></li>
                <li><a href="https://twitter.com/alice_henley1" data-placement="bottom" title="Twitter"><i class="fab fa-twitter icon-social icon-48"></i></a></li>
                <li><a href="https://www.facebook.com/AliceHenley" data-placement="bottom" title="Facebook"><i class="fab fa-facebook icon-social icon-48"></i></a></li>
                <li><a href="https://www.linkedin.com/in/alice-henley-489b8610a/" data-placement="bottom" title="Linkedin"><i class="fab fa-linkedin icon-social icon-48"></i></a></li>
                <li><a href="https://www.researchgate.net/profile/Alice_Henley3" data-placement="bottom" title="Research gate">
                    <i class="fab fa-researchgate icon-social icon-48"></i>
                  </a></li>
                <!-- <li><a href="" data-placement="bottom" title="Pinterest"><i class="icon-pinterest icon-square icon-32"></i></a></li> -->
                <!-- <li><a href="#" data-placement="bottom" title="Google plus"><i class="icon-google-plus icon-square icon-32"></i></a></li> -->
              </ul>
            </div>
        </div>
      </div>
    </div>
    <div class="verybottom">
      <div class="container">
        <div class="row">
          <div class="span6">
            <p>
              © Lumia - All right reserved
            </p>
          </div>
          <div class="span6">
            <div class="pull-right">
              <div class="credits">
                <!--
                    All the links in the footer should remain intact.
                    You can delete the links only if you purchased the pro version.
                    Licensing information: https://bootstrapmade.com/license/
                    Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/buy/?theme=Lumia
                  -->
                Created by <a href="https://bootstrapmade.com/">BootstrapMade</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
</footer>
  </div>
  <!-- end wrapper -->
  <a href="#" class="scrollup"><i class="fas fa-chevron-circle-up icon-square icon-48 active"></i></a>

  <script src="/assets/js/jquery.js"></script>
  <script src="/assets/js/raphael-min.js"></script>
  <script src="/assets/js/jquery.easing.1.3.js"></script>
  <script src="/assets/js/bootstrap.js"></script>
  <script src="/assets/js/google-code-prettify/prettify.js"></script>
  <script src="/assets/js/jquery.elastislide.js"></script>
  <script src="/assets/js/jquery.prettyPhoto.js"></script>
  <script src="/assets/js/jquery.flexslider.js"></script>
  <script src="/assets/js/jquery-hover-effect.js"></script>
  <script src="/assets/js/animate.js"></script>

  <!-- Template Custom JavaScript File -->
  <script src="/assets/js/custom.js"></script>

</body>
</html>